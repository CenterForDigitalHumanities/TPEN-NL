<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>LOGIN</title>
        <meta charset="UTF-8">
        <link type="text/css" href="css/custom-theme/jQuery.css" rel="Stylesheet" />
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.js"></script>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.js"></script> 
        <script type="text/javascript" src="js/newberry.js"></script>
    </head>
    <style>
        #bypassLogin{
                width: 100%;
                background-color: #808080;
                text-align: center;
                margin-bottom: 30px;
                padding: 14px 0px;
        }
        #bypassLogin button{
            padding: 8px 7px;
            background-color: #FFF;
            cursor: pointer;
            font-weight: bold;
        }
        
        #bypassLogin button:hover{
            color: blue;
        }
        
        #loginsuccess, #loginfail{
            display: none;
            cursor: default !important;
        }
    </style>
    <body>
        <div id="bypassLogin"><button onclick="bypass();">Bypass Login</button></div> <!--<button onclick="testCreate();">Test Create</button>-->
            <div id="main" class="ui-widget ui-widget-content ui-corner-all ui-tabs ui-helper-reset ui-helper-clearfix">
                <div id="login" class="left">
                    <h3 class="ui-widget-header ui-tabs ui-corner-all ui-state-default">Log In</h3>
                    <p> 
                        If you have your local T-PEN database set up and would like to login to test getting projects you can do so here.  The transcription interface will work
                        independent of a database if you do not have your local T-PEN database prepared.  To bypass login, <a href="frenchTranscription.html">go to the transcription page directly</a>.  The URL is frenchTranscription.html  
                        <br>  If you bypass login, all you need is a T-PEN or IIIF manifest.  The images in the manifest must be public
                        for the transcription interface to get the images/annotations/other metadata.  If the login the images are behind leave a cookie in the browser to indicate a valid login session, then login to that location in another
                        tab and the transcription interface will be able to get the images.  
                    </p>

                <div id="userLogin">
                    <div>Login Here:</div>
                    <label for="uname">Email</label> <input class="text" type="text" id="uname"/> <br/>
                    <label for="password">Password</label> <input class="text" type="password" id="password"/> <br/>
                    <input class="ui-button ui-state-default ui-corner-all right" type="button" title="Log In" value="Log In"
                           onclick="userLogin();">
                    <input id="loginsuccess" style="background: none; background-color:white;" class="ui-button ui-state-default ui-corner-all right" type="button" value="Login Success">
                    <input id="loginfail" style="background: none; background-color:white;" class="ui-button ui-state-default ui-corner-all right" type="button" value="Login Fail">
                </div>
<!--TODO                
            <div id="register" class="right">
                <h3 class="ui-widget-header ui-tabs ui-corner-all ui-state-default">Register a New Account</h3>
                <form>
                    <fieldset>
                        <legend>or Register as a New User:</legend>
                        Note: You will receive your password via email after your account is activated by an administrator
                        <label for="uname">Email</label><input class="text" type="text" name="uname"/><br/>
                        <label for="fname">First Name</label><input class="text" type="text" name="fname"/><br/>
                        <label for="lname">Last Name</label><input class="text" type="text" name="lname"/><br/>
                        <input type="submit" value="Register" class=""/>
                   </fieldset>
                </form>
            </div>
-->

<!--TODO                        
                <div id="resetPassword">
                    <h6 id="forgetFormBtn" class="clear-right">Forgot your Password?</h6>
                    <form id="forgetForm" action="admin.jsp" method="POST" class="ui-corner-all">
                    <span>Enter the email address associated with your account to have your password reset.</span>
                        <input id="email" type="text" style="width:220px;" placeholder="Forgot your password?" name="email">
                        <input class="right ui-corner-all ui-state-default" type="submit" name="emailSubmitted" value="Reset Password"/>
                    </form>
                </div>
-->
            </div>
        </div>
        
    </body>
</html>
<script>
    function bypass(){
        window.location.href = "frenchTranscription.html";
    }
    function testCreate(){
        var url = 'createProject';
        var testObj = {
  "@context" : "http://www.shared-canvas.org/ns/context.json",
  "@id" : "http://t-pen.org/TPEN/manifest/6716/manifest.json",
  "@type" : "sc:Manifest",
  "label" : "scroll, test  1",
  "metadata" : [ {
    "label" : "title",
    "value" : "scroll, test  1"
  }, {
    "label" : "subtitle",
    "value" : " "
  }, {
    "label" : "msIdentifier",
    "value" : " "
  }, {
    "label" : "msSettlement",
    "value" : " "
  }, {
    "label" : "msRepository",
    "value" : " "
  }, {
    "label" : "msIdNumber",
    "value" : " "
  }, {
    "label" : "subject",
    "value" : " "
  }, {
    "label" : "date",
    "value" : ""
  }, {
    "label" : "language",
    "value" : ""
  }, {
    "label" : "author",
    "value" : ""
  }, {
    "label" : "description",
    "value" : " "
  }, {
    "label" : "location",
    "value" : ""
  }, {
    "label" : "msCollection",
    "value" : " "
  } ],
  "service" : [ {
    "@context" : "http://iiif.io/api/auth/1/context.json",
    "@id" : "http://t-pen.org/TPEN/login.jsp",
    "profile" : "http://iiif.io/api/auth/1/login",
    "label" : "T-PEN Login",
    "header" : "Login for image access",
    "description" : "Agreement requires an open T-PEN session to view images",
    "confirmLabel" : "Login",
    "failureHeader" : "T-PEN Login Failed",
    "failureDescription" : "<a href=\"http://t-pen.org/TPEN/about.jsp\">Read Agreement</a>",
    "service" : [ {
      "@id" : "http://t-pen.org/TPEN/login.jsp",
      "profile" : "http://iiif.io/api/auth/1/logout",
      "label" : "End T-PEN Session"
    } ]
  } ],
  "sequences" : [ {
    "@id" : "http://t-pen.org/TPEN/manifest/6716/sequence/normal",
    "@type" : "sc:Sequence",
    "label" : "Current Page Order",
    "canvases" : [ {
      "@id" : "http://t-pen.org/TPEN/canvas/13244492",
      "@type" : "sc:Canvas",
      "label" : "case_ms_122_scroll_02.jpg",
      "width" : 166,
      "height" : 1000,
      "otherContent" : [ {
        "@id" : "http://t-pen.org/TPEN/project/6716/annotations/13244492",
        "@type" : "sc:AnnotationList",
        "label" : "http://t-pen.org/TPEN/canvas/13244492 List",
        "proj" : 6716,
        "on" : "http://t-pen.org/TPEN/canvas/13244492",
        "@context" : "http://iiif.io/api/presentation/2/context.json",
        "resources" : [ {
          "@id" : "http://t-pen.org/TPEN/line/104227894",
          "_tpen_line_id" : "line/104227894",
          "@type" : "oa:Annotation",
          "motivation" : "oad:transcribing",
          "resource" : {
            "@type" : "cnt:ContentAsText",
            "cnt:chars" : ""
          },
          "on" : "http://t-pen.org/TPEN/canvas/13244492#xywh=31,35,94,902",
          "_tpen_note" : "",
          "_tpen_creator" : 489,
          "modified" : "2018-11-02 15:15:59.0"
        } ]
      } ],
      "images" : [ {
        "@type" : "oa:Annotation",
        "motivation" : "sc:painting",
        "resource" : {
          "@id" : "http://t-pen.org/TPEN/imageResize?folioNum=13244492&height=2000&user=null",
          "@type" : "dctypes:Image",
          "format" : "image/jpeg"
        },
        "on" : "http://t-pen.org/TPEN/canvas/13244492"
      } ]
    } ]
  } ]
};
        //var testObj = {"attribution": "Provided by Harvard University", "structures": [], "label": "MS Typ 41. Houghton Library, Harvard University. Chronique du monde depuis la cr\u00e9ation, et des rois de France et d'Angleterre, jusqu'\u00e0 l'an 1461 : manuscript, [ca. 1461]", "sequences": [{"canvases": [{"label": "41", "width": 6251, "images": [{"resource": {"service": {"profile": "http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1", "@id": "http://ids.lib.harvard.edu/ids/iiif/48530377"}, "format": "image/jpeg", "height": 109517, "width": 6251, "@id": "http://ids.lib.harvard.edu/ids/iiif/48530377/full/full/full/native", "@type": "dcterms:Image"}, "on": "http://oculus-dev.harvardx.harvard.edu/manifests/drs:48309543/canvas/canvas-48530377.json", "motivation": "sc:painting", "@id": "http://oculus-dev.harvardx.harvard.edu/manifests/drs:48309543/annotation/anno-48530377.json", "@type": "oa:Annotation"}], "height": 109517, "@id": "http://oculus-dev.harvardx.harvard.edu/manifests/drs:48309543/canvas/canvas-48530377.json", "@type": "sc:Canvas"}], "viewingDirection": "left-to-right", "@id": "http://oculus-dev.harvardx.harvard.edu/manifests/drs:48309543/sequence/normal.json", "@type": "sc:Sequence", "viewingHint": "paged"}], "@context": "http://www.shared-canvas.org/ns/context.json", "@id": "http://oculus-dev.harvardx.harvard.edu/manifests/drs:48309543", "@type": "sc:Manifest", "seeAlso": "http://hollisclassic.harvard.edu/F?func=find-c&CCL_TERM=sys=9520434"}
        var params = {"scmanifest": JSON.stringify(testObj)};
        $.post(url, params, function(data){
            //console.log(data);
        });
    }
    function userLogin(){
        var userName = $('#uname').val();
        var password = $('#password').val();
        if(userName !== undefined && userName !== "" && password !== undefined && password !== ""){
            var url = "login";
            var params = {"uname":userName, "password":password};
            $.post(url, params, function(){
                
            })
            .done(function(){
                //console.log("login success");
                $("#loginfail").hide();  
                $("#loginsuccess").show();
            })
            .fail(function(){
                $("#loginfail").show();  
                $("#loginsuccess").hide();
            });
        }
        else{
            alert('You must enter a user name (E-mail) and password!');
        }            
    }
    
    function registerNewUser(){
        //Need an API? 
    }
    
</script>
    
