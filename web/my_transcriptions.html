<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!--<script src="js/manuscriptFilters.js" type="text/javascript"></script>-->
        <script src="js/tpen.js" type="text/javascript"></script>
        <!--<link rel="stylesheet" href="css/tpen.css" type="text/css" media="screen, projection">-->
        <link rel="stylesheet" href="css/style.css" type="text/css" media="screen, projection">
    </head>
    <body>
        <header>Header</header>
        <div class="record" data-id="maybe">
            <h4>A Label</h4>
            <div class="row">
                <img class="thumbnail" src="http://placekitten.com/65/80">
                <dl>
                </dl>
            </div>
            <div class="btn-group">
                <a href="somewhere">Button</a> <a href="somewhere">DO</a>
            </div>
        </div>
        <footer>Header</footer>
    </body>
    <script type="text/javascript">
        //getAllProjectsForThisUserFromDataset("please")
        function getUserProjects(projectID, userID, username){
            var url = "projects?username="+username;
            //How can I check if current user is the admin of the project? 
            var projectName = "";
            $.ajax({
                url: url,
                type:"GET",
                success: function(data){
                    var userProjects = data;
                    $.each(userProjects, function(){
                        //the project name is properly decoded here.
                        projectName = this.name;
                        projectName=decodeURIComponent(projectName);
                        var projectID = this.id;
                        projectID = projectID.replace("projects/", "");
                        //console.log('User is admin: '+userIsProjectAdmin)
                        if(!userIsProjectAdmin){
                            $('#projectList').append("<li><a title=\"" + projectName + "\" class=\"tpenButton projectTitle\" href='project.html?projectID="+projectID+"'>"+projectName+"</a></li>");
                        }
                        else{
                            $('#projectList').append("<li projectID='"+projectID+"'>\n\
                            <a title=\"" + projectName + "\" class=\"tpenButton projectTitle\" href='project.html?projectID="+projectID+"'> "+projectName+" </a>\n\
                            <span style='z-index:1; cursor:pointer;' title=\"delete project\" class=\"delete ui-icon ui-icon-closethick right\" onclick=\"deleteProject("+projectID+");\"></span>\n\
                            </li>");
                    //<span style='z-index:1000; cursor:pointer;' title=\"delete project\" class=\"delete ui-icon ui-icon-closethick right\" onclick=\"deleteProject();\"></span>
                        }
                    });
                },
                error: function(jqXHR,error, errorThrown) {  
                    if(jqXHR.status && jqXHR.status==400){
                         alert(jqXHR.responseText); 
                    }
                    else if (jqXHR.status && jqXHR.status==404){
                        alert("A project does not exist with this ID:"+projectID+".  Try with a different ID.");
                    }
                }
            });
        }
    </script>
</html>
