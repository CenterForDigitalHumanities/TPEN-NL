<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!--<script src="js/manuscriptFilters.js" type="text/javascript"></script>-->
        <script src="js/tpen.js" type="text/javascript"></script>
        <!--<link rel="stylesheet" href="css/tpen.css" type="text/css" media="screen, projection">-->
        <link rel="stylesheet" href="css/style.css" type="text/css" media="screen, projection">
    </head>
    <body>
        <header>Header</header>
        <div id="projectsList" class="record" data-id="maybe">
            <h4>A Label</h4>
            <div class="row">
                <img class="thumbnail" src="http://placekitten.com/65/80">
                <dl>
                </dl>
            </div>
            <div class="btn-group">
                <a href="somewhere">Button</a> <a href="somewhere">DO</a>
            </div>
        </div>
        <footer>Header</footer>
    </body>
    <script type="text/javascript">
        /**
         * Request for all projects that belong to the provided userID.
         * @param {type} lookupID The user id whose project list needs to be retrieved.  
         * @returns {Promise}
         */
        let getUserProjects = async function(lookupID){
            let url = "projects";
            let projectName = "";
            return projectList =  await fetch(url)
                .then(resp => resp.json())
                .catch(err => {return err})
        }
        
        /**
         * Turn project data into a rendered HTML project list
         * @param {JSONArray} Array of project data, each data node is a JSON Object.
         */
        let formatAndRenderProjects = function(projectList){
            //FIXME how do I know if a given project is French, Italian, Spanish, etc.
            projectsList.innerHTML = projectList.reduce((a, b) => a += `
            <div class="record" data-id="${b.id}">
                <h4>${b.name}</h4>
                <div class="row">
                    <img class="thumbnail" src="http://placekitten.com/65/80">
                    <dl>
                    </dl>
                </div>
                <div class="btn-group">
                    <a href="./newberryTrans.html?projectID=${b.id}">View Transcription</a>
                    <span style='z-index:1; cursor:pointer;' title=\"delete project\" class=\"delete ui-icon ui-icon-closethick right\" onclick=\"deleteProject("${b.id}");\">Delete Transcription</span>
                </div>
            </div>`, ``)
        }
        
        //Page initializer
        getUserProjects(000).then(projects => {formatAndRenderProjects(projects)})
        .catch(err => {
            alert("Could not get user projects.")
            console.error(err)
        })

    </script>
</html>
